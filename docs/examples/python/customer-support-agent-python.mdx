---
title: "Customer Support Agent"
sidebarTitle: "Customer Support Agent"
icon: "headset"
description: "This project demonstrates how to create a customer support agent using Composio and Swarm. The agent can search the internet, maintain a knowledge base using RAG, log queries in Google Sheets, and create Linear issues for unresolved queries. It provides a user-friendly Gradio interface for interaction."
---

<Card color="#7bee0c" title="Customer Support Agent GitHub Repository" icon="github" href="https://github.com/ComposioHQ/composio/tree/master/python/examples/quickstarters/customer_support">
  Explore the complete source code for the Customer Support Agent project. This repository contains all the necessary files and scripts to set up and run the system using Swarm and Composio.
</Card>

<Steps>
    <Step title="Import Required Packages">
    Import necessary packages for the Customer Support Agent:
    <CodeGroup>
        ```python Import libraries
        import gradio as gr
        from swarm import Agent, Swarm
        from composio import ComposioToolSet, Action
        from dotenv import load_dotenv
        ```
    </CodeGroup>
    </Step>

    <Step title="Initialize Composio Toolset">
    Set up the Composio toolset and environment:
    <CodeGroup>
        ```python Initialize Toolset
        load_dotenv()
        toolset = ComposioToolSet()
        ```
    </CodeGroup>
    </Step>

    <Step title="Define Helper Functions">
    Create functions to interact with various tools:
    <CodeGroup>
        ```python Helper Functions
        def google_sheet_action(values):
            """Adds values to the google sheet"""
            spreadsheet_id="1yTa_5uaX7_fRKiejpw6FitLTV04uGJHUUMV5v18Quoo"
            sheet_name="Sheet1"
            res = toolset.execute_action(
                action=Action.GOOGLESHEETS_BATCH_UPDATE,
                params={},
                text=f"this is the spreadsheet id:{spreadsheet_id}, values to add {values}, in sheet {sheet_name} ",
                entity_id="default",
            )
            return res

        def search(query):
            """Searches the internet"""
            res = toolset.execute_action(
                action=Action.EXA_SEARCH,
                params={"query":query},
                entity_id="default"
            )
            return res

        def scrape(webpage_link):
            """Scrapes webpage content"""
            res = toolset.execute_action(
                action=Action.WEBTOOL_SCRAPE_WEBSITE_CONTENT,
                params={},
                text=webpage_link,
                entity_id="default"
            )
            return res
        ```
    </CodeGroup>
    </Step>

    <Step title="Define RAG Functions">
    Set up functions for RAG (Retrieval Augmented Generation) operations:
    <CodeGroup>
        ```python RAG Functions
        def add_rag(data):
            """Add content to vector store"""
            res = toolset.execute_action(
                action=Action.RAGTOOL_ADD_CONTENT_TO_RAG_TOOL,
                params={'content':data},
                text="content to add"+data,
                entity_id="default"
            )

        def query_rag(query):
            """Query RAG"""
            res = toolset.execute_action(
                action=Action.RAGTOOL_RAG_TOOL_QUERY,
                params={},
                text=query,
                entity_id="default"
            )
        ```
    </CodeGroup>
    </Step>

    <Step title="Create Linear Issue Function">
    Define function to create issues in Linear:
    <CodeGroup>
        ```python Linear Integration
        def linear_issue(issue_title, issue_description):
            projects_id = toolset.execute_action(
                Action.LINEAR_LIST_LINEAR_PROJECTS,
                params={},
                entity_id='default'
            )

            team_id = toolset.execute_action(
                Action.LINEAR_LIST_LINEAR_TEAMS,
                params={},
                text="find project id here:"+str(projects_id),
            )
            res = toolset.execute_action(
                action=Action.LINEAR_CREATE_LINEAR_ISSUE,
                params={},
                text=f"issue_title:{issue_title}, issue_description:{issue_description}, project_id:{str(projects_id)}, teams id:{str(team_id)}"
            )
        ```
    </CodeGroup>
    </Step>

    <Step title="Set up Swarm Agent">
    Initialize the Swarm client and create the researcher agent:
    <CodeGroup>
        ```python Agent Setup
        client = Swarm()

        agent_a = Agent(
            name="Researcher",
            instructions="""
            EXECUTE ALL TOOL CALLS, You answer queries based on internet searches. First search each link then scrape the content and add it in RAG
            You query the RAG Vector Store first if the answer is satisfactory
            you create tickets in google spreadsheet, in the format of columns [queries] [solutions] and [resolved?] 
            Also create a linear issue if it is not resolved
            Return the final answer to the question
            """,
            functions=[search, add_rag, query_rag, google_sheet_action, linear_issue],
        )
        ```
    </CodeGroup>
    </Step>

    <Step title="Create Query Processing Function">
    Define the function to process user queries:
    <CodeGroup>
        ```python Query Processing
        def process_query(query):
            response = client.run(
                agent=agent_a,
                messages=[{"role": "user", "content": query + "This is query from a user, answer it and ensure it is logged in the google sheet"}],
                execute_tools=True,
            )
            return response.messages[-1]["content"]
        ```
    </CodeGroup>
    </Step>

    <Step title="Set up Gradio Interface">
    Create and launch the Gradio interface:
    <CodeGroup>
        ```python Gradio Interface
        iface = gr.Interface(
            fn=process_query,
            inputs=gr.Textbox(lines=2, placeholder="Enter your query here..."),
            outputs="text",
            title="Swarm Agent Query Interface",
            description="Enter your query and get responses from the Swarm Agent. The agent will search the internet, use RAG, and log the query in a Google Sheet.",
        )

        iface.launch()
        ```
    </CodeGroup>
    </Step>
</Steps>

## Complete Code

Here's the complete Python code:
<CodeGroup>
```python Python Final Code
import gradio as gr
from swarm import Agent, Swarm
from composio import ComposioToolSet, Action
from dotenv import load_dotenv
load_dotenv()
toolset = ComposioToolSet()

def google_sheet_action(values):
    spreadsheet_id="1yTa_5uaX7_fRKiejpw6FitLTV04uGJHUUMV5v18Quoo" # sample sheet id
    sheet_name="Sheet1"
    res = toolset.execute_action(
    action=Action.GOOGLESHEETS_BATCH_UPDATE,
    params={},
    text=f"this is the spreadsheet id:{spreadsheet_id}, values to add {values}, in sheet {sheet_name} ",
    entity_id="default",
    )
return res
def search(query):
    res = toolset.execute_action(
    action=Action.EXA_SEARCH,
    params={"query":query},
    entity_id="default"
    )
    return res
def scrape(webpage_link):
    res = toolset.execute_action(
    action=Action.WEBTOOL_SCRAPE_WEBSITE_CONTENT,
    params={},
    text=webpage_link,
    entity_id="default"
    )
    return res
def add_rag(data):
    res = toolset.execute_action(
    action=Action.RAGTOOL_ADD_CONTENT_TO_RAG_TOOL,
    params={'content':data},
    text="content to add"+data,
    entity_id="default"
    )
def query_rag(query):
    res = toolset.execute_action(
    action=Action.RAGTOOL_RAG_TOOL_QUERY,
    params={},
    text=query,
    entity_id="default"
    )
def linear_issue(issue_title, issue_description):
    projects_id = toolset.execute_action(
        Action.LINEAR_LIST_LINEAR_PROJECTS,
        params={},
        entity_id='default'
    )
    team_id = toolset.execute_action(
        Action.LINEAR_LIST_LINEAR_TEAMS,
        params={},
        text="find project id here:"+str(projects_id),
    )
    res = toolset.execute_action(
        action=Action.LINEAR_CREATE_LINEAR_ISSUE,
        params={},
        text=f"issue_title:{issue_title}, issue_description:{issue_description}, project_id:{str(projects_id)}, teams id:{str(team_id)}"
    )
client = Swarm()
agent_a = Agent(
    name="Researcher",
    instructions="""
    EXECUTE ALL TOOL CALLS, You answer queries based on internet searches. First search each link then scrape the content and add it in RAG
    You query the RAG Vector Store first if the answer is satisfactory
    you create tickets in google spreadsheet, in the format of columns [queries] [solutions] and [resolved?]
    Also create a linear issue if it is not resolved
    Return the final answer to the question
    """,
    functions=[search, add_rag, query_rag, google_sheet_action, linear_issue],
)
def process_query(query):
    response = client.run(
    agent=agent_a,
    messages=[{"role": "user", "content": query + "This is query from a user, answer it and ensure it is logged in the google sheet"}],
    execute_tools=True,
    )
    return response.messages[-1]["content"]
iface = gr.Interface(
fn=process_query,
inputs=gr.Textbox(lines=2, placeholder="Enter your query here..."),
outputs="text",
title="Swarm Agent Query Interface",
description="Enter your query and get responses from the Swarm Agent. The agent will search the internet, use RAG, and log the query in a Google Sheet.",
)
iface.launch()
```
</CodeGroup>
